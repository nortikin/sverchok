<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Formula Node Mk4 &#8212; Sverchok 1, 2, 0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/zerovm.css?v=bbc7d13e" />
    <script src="../../_static/documentation_options.js?v=773c2105"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../../_static/sverchock_icon_b.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Generative Art" href="generative_art.html" />
    <link rel="prev" title="Formula Interpolate" href="formula_interpolate.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="generative_art.html" title="Generative Art"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="formula_interpolate.html" title="Formula Interpolate"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../main.html">Sverchok 1, 2, 0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../nodes.html" >Nodes</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="script_index.html" accesskey="U">Script</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Formula Node Mk4</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="formula-node-mk4">
<h1>Formula Node Mk4<a class="headerlink" href="#formula-node-mk4" title="Link to this heading">¶</a></h1>
<section id="functionality">
<h2>Functionality<a class="headerlink" href="#functionality" title="Link to this heading">¶</a></h2>
<p>Formula+ (this is very similar to mk3 with a few notable exceptions)</p>
<p>This node allows one to evaluate (almost) arbitrary Python expressions, using inputs as variables.
It is possible to calculate numeric values, construct lists, tuples, vertices and matrices.</p>
<p>The node allows to evaluate up to 4 formulas for each set of input values.</p>
</section>
<section id="expression-syntax">
<h2>Expression syntax<a class="headerlink" href="#expression-syntax" title="Link to this heading">¶</a></h2>
<p>Syntax being used for formulas is standard Python’s syntax for expressions.
For exact syntax definition, please refer to <a class="reference external" href="https://docs.python.org/3/reference/expressions.html">https://docs.python.org/3/reference/expressions.html</a>.</p>
<p>In short, you can use usual mathematical operations (<cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>**</cite> for power), numbers, variables, parenthesis, and function call, such as <cite>sin(x)</cite>.</p>
<p>One difference with Python’s syntax is that you can call only restricted number of Python’s functions. Allowed are:</p>
<ul class="simple">
<li><p>Functions from math module:</p>
<ul>
<li><p>acos, acosh, asin, asinh, atan, atan2,
atanh, ceil, copysign, cos, cosh, degrees,
erf, erfc, exp, expm1, fabs, factorial, floor,
fmod, frexp, fsum, gamma, hypot, isfinite, isinf,
isnan, ldexp, lgamma, log, log10, log1p, log2, modf,
pow, radians, sin, sinh, sqrt, tan, tanh, trunc;</p></li>
</ul>
</li>
<li><p>Constants from math module: pi, e;</p></li>
<li><p>Additional functions: abs, sign, max, min, len, sum, any, all, dir;</p></li>
<li><p>From mathutlis module: Vector, Matrix;</p></li>
<li><p>Python type conversions: tuple, list, str, dict, set, int, float.</p></li>
<li><p>External modules: np (for Numpy) and bpy (for blender data)</p></li>
</ul>
<p>This restriction is for security reasons. However, Python’s ecosystem does not guarantee that no one can call some unsafe operations by using some sort of language-level hacks. So, please be warned that usage of this node with JSON definition obtained from unknown or untrusted source can potentially harm your system or data.</p>
<p>Examples of valid expressions are:</p>
<ul class="simple">
<li><p>1.0</p></li>
<li><p>x</p></li>
<li><p>x+1</p></li>
<li><p>0.75*X + 0.25*Y</p></li>
<li><p>R * sin(phi)</p></li>
<li><dl class="simple">
<dt>f-string formatting is possible. like:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">f&quot;{x:04}&quot;</span></code> will return a zero padding of length 4 if positive numbers are passed in.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="inputs">
<h2>Inputs<a class="headerlink" href="#inputs" title="Link to this heading">¶</a></h2>
<ul>
<li><p>Set of inputs for this node depends on used formulas. Each variable used in formula becomes one input. If there are no variables used in formula, then this node will have no inputs.</p></li>
<li><dl class="simple">
<dt>If you specify variables, and the node creates a socket for it, then you must connect a link into that socket, otherwise the node will return early and not process anything. (but it might still output from the previously cached result.</dt><dd><ul class="simple">
<li><p>the node will warn you using a message to say that the UI is not fully connected.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>The inputs have two properties, Depth and Transform:
- Depth: Exposed depth to the formula. 1 means exposing scalars, 2 means scalar list, 3 list of lists…
- Transform: Transformation done to the data before exposing to the formula. Offers:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘As Is’: Do not transform</p></li>
<li><p>‘Vector’: Transforms to mathutils Vector</p></li>
<li><p>‘Array’: Transforms to Numpy Array</p></li>
<li><p>‘Set’: Transforms to python set</p></li>
<li><p>‘String’: Transforms to regular string</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<p>This node has the following parameters:</p>
<ul class="simple">
<li><p><strong>Dimensions</strong>. This parameter is available in the N panel only. It defines how many formulas the node will allow to specify and evaluate. Default value is 1. Maximum value is 4.</p></li>
<li><p><strong>Formula 1</strong> to <strong>Formula 4</strong> input boxes. Formulas theirselve. If no formula is specified, then nothing will be calculated for this dimension. Number of formula input boxes is defined by <strong>Dimensions</strong> parameter.</p></li>
<li><p><strong>Split</strong>. If the flag is set, then for each combination of input values, list of values calculated by formula is enclosed in separate list. Usually you will want to uncheck this if you are using only one formula. Usually you will want to check this if you are using more than one formula. Other combinations can be of use in specific cases. Unchecked by default.</p></li>
<li><dl class="simple">
<dt><strong>Wrapping</strong>.</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code>: removes an outer layer of square brackets</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.0</span></code>: does nothing to the output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+1</span></code>: will wrap the output one more time.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Use AST</strong>: (Default is off)</dt><dd><ul>
<li><p>this mode is only available in socket-less mode. You may want to look at the implementation source if it’s doing things you aren’t expecting.</p></li>
<li><p>With AST off the original <code class="docutils literal notranslate"><span class="pre">safe_eval</span></code> is used.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><strong>List Match</strong>: list length matching method.</p></li>
<li><p><strong>List Output</strong>: Convert the output to list.</p></li>
<li><p><strong>Output</strong>: Output socket type.</p></li>
</ul>
<p>For example, let’s consider the following setup:</p>
<img alt="https://user-images.githubusercontent.com/284644/53962080-00c78700-410c-11e9-9563-855fca16537a.png" src="https://user-images.githubusercontent.com/284644/53962080-00c78700-410c-11e9-9563-855fca16537a.png" />
<p>Then the following combinations of flags are possible:</p>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Link to this heading">¶</a></h2>
<p><strong>Result</strong> - what we got as result.</p>
</section>
<section id="usage-examples">
<h2>Usage examples<a class="headerlink" href="#usage-examples" title="Link to this heading">¶</a></h2>
<p>Emulating the Compute mask node:</p>
<img alt="https://user-images.githubusercontent.com/10011941/106862493-802eae00-66c7-11eb-9dee-6f1ff92e98be.png" src="https://user-images.githubusercontent.com/10011941/106862493-802eae00-66c7-11eb-9dee-6f1ff92e98be.png" />
<p>Using Vectors</p>
<img alt="https://user-images.githubusercontent.com/10011941/106863547-fa136700-66c8-11eb-8a0b-26dfc53d0836.png" src="https://user-images.githubusercontent.com/10011941/106863547-fa136700-66c8-11eb-8a0b-26dfc53d0836.png" />
<p>Numpy can be used for calculations</p>
<img alt="https://user-images.githubusercontent.com/10011941/106864164-cab12a00-66c9-11eb-893c-703d87705b23.png" src="https://user-images.githubusercontent.com/10011941/106864164-cab12a00-66c9-11eb-893c-703d87705b23.png" />
<p>Example exposing attributes of a surface and using the node to perform a to_nurbs transform</p>
<img alt="https://user-images.githubusercontent.com/10011941/106862141-fda5ee80-66c6-11eb-844f-8b0d6996f18b.png" src="https://user-images.githubusercontent.com/10011941/106862141-fda5ee80-66c6-11eb-844f-8b0d6996f18b.png" />
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../main.html">
              <img class="logo" src="../../_static/title_big_b.svg" alt="Logo of Sverchok"/>
            </a></p>
  <div>
    <h3><a href="../../main.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Formula Node Mk4</a><ul>
<li><a class="reference internal" href="#functionality">Functionality</a></li>
<li><a class="reference internal" href="#expression-syntax">Expression syntax</a></li>
<li><a class="reference internal" href="#inputs">Inputs</a></li>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#outputs">Outputs</a></li>
<li><a class="reference internal" href="#usage-examples">Usage examples</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="formula_interpolate.html"
                          title="previous chapter">Formula Interpolate</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="generative_art.html"
                          title="next chapter">Generative Art</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/nodes/script/formula_mk5.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="generative_art.html" title="Generative Art"
             >next</a> |</li>
        <li class="right" >
          <a href="formula_interpolate.html" title="Formula Interpolate"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../main.html">Sverchok 1, 2, 0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../nodes.html" >Nodes</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="script_index.html" >Script</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Formula Node Mk4</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2014...2025, sverchok team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>