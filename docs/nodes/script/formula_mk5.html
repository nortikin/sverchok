<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Formula Node Mk4 &mdash; Sverchok 1, 1, 0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/sverchock_icon_b.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Formula Interpolate" href="formula_interpolate.html" />
    <link rel="prev" title="Script" href="script_index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../main.html" class="icon icon-home"> Sverchok
            <img src="../../_static/title_big_b.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1, 1, 0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_interface/user_interface.html">User interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tree_evaluation_system.html">Node tree evaluation system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_structure/data_structure_index.html">Data structure</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../nodes.html">Nodes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../generator/generator_index.html">Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../generators_extended/generators_extended_index.html">Generators Extended</a></li>
<li class="toctree-l2"><a class="reference internal" href="../curve/curve_index.html">Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../surface/surface_index.html">Surfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../field/field_index.html">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../solid/solid_index.html">Solids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spatial/spatial_index.html">Spatial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transforms/transforms_index.html">Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analyzer/analyzer_index.html">Analyzers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modifier_change/modifier_change_index.html">Modifier Change</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modifier_make/modifier_make_index.html">Modifier Make</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CAD/CAD_index.html">CAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../number/number_index.html">Number</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vector/vector_index.html">Vector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matrix/matrix_index.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quaternion/quaternion_index.html">Quaternion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color/color_index.html">Color</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logic/logic_index.html">Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../list_main/list_main_index.html">List Main</a></li>
<li class="toctree-l2"><a class="reference internal" href="../list_struct/list_struct_index.html">List Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../list_masks/list_masks_index.html">List Masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../list_mutators/list_mutators_index.html">List Mutators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dictionary/dictionary_index.html">Dictionary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../viz/viz_index.html">Viz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../text/text_index.html">Text</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="script_index.html">Script</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Formula Node Mk4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#functionality">Functionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="#expression-syntax">Expression syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inputs">Inputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#outputs">Outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage-examples">Usage examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="formula_interpolate.html">Formula Interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="multi_exec.html">Exec Node Mod</a></li>
<li class="toctree-l3"><a class="reference internal" href="multi_exec.html#features">features</a></li>
<li class="toctree-l3"><a class="reference internal" href="script1_lite.html">Script Node Lite</a></li>
<li class="toctree-l3"><a class="reference internal" href="topology_simple.html">Topology Simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="sn_functor_b.html">SN Functor B</a></li>
<li class="toctree-l3"><a class="reference internal" href="profile_mk3.html">Profile Parametric Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="mesh_eval.html">Mesh Expression Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="generative_art.html">Generative Art</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../scene/scene_index.html">Scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="../object_nodes/object_nodes_index.html">Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../layout/layout_index.html">Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network/network_index.html">Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pulga_physics/pulga_physics_index.html">Pulga Physics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exchange/exchange_index.html">Exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../svg/svg_index.html">SVG</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/contributing_to_sverchok.html">Contributing to sverchok</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../main.html">Sverchok</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../main.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../nodes.html">Nodes</a> &raquo;</li>
          <li><a href="script_index.html">Script</a> &raquo;</li>
      <li>Formula Node Mk4</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/nodes/script/formula_mk5.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="formula-node-mk4">
<h1>Formula Node Mk4<a class="headerlink" href="#formula-node-mk4" title="Permalink to this heading">¶</a></h1>
<section id="functionality">
<h2>Functionality<a class="headerlink" href="#functionality" title="Permalink to this heading">¶</a></h2>
<p>Formula+ (this is very similar to mk3 with a few notable exceptions)</p>
<p>This node allows one to evaluate (almost) arbitrary Python expressions, using inputs as variables.
It is possible to calculate numeric values, construct lists, tuples, vertices and matrices.</p>
<p>The node allows to evaluate up to 4 formulas for each set of input values.</p>
</section>
<section id="expression-syntax">
<h2>Expression syntax<a class="headerlink" href="#expression-syntax" title="Permalink to this heading">¶</a></h2>
<p>Syntax being used for formulas is standard Python’s syntax for expressions.
For exact syntax definition, please refer to <a class="reference external" href="https://docs.python.org/3/reference/expressions.html">https://docs.python.org/3/reference/expressions.html</a>.</p>
<p>In short, you can use usual mathematical operations (<cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>**</cite> for power), numbers, variables, parenthesis, and function call, such as <cite>sin(x)</cite>.</p>
<p>One difference with Python’s syntax is that you can call only restricted number of Python’s functions. Allowed are:</p>
<ul class="simple">
<li><p>Functions from math module:</p>
<ul>
<li><p>acos, acosh, asin, asinh, atan, atan2,
atanh, ceil, copysign, cos, cosh, degrees,
erf, erfc, exp, expm1, fabs, factorial, floor,
fmod, frexp, fsum, gamma, hypot, isfinite, isinf,
isnan, ldexp, lgamma, log, log10, log1p, log2, modf,
pow, radians, sin, sinh, sqrt, tan, tanh, trunc;</p></li>
</ul>
</li>
<li><p>Constants from math module: pi, e;</p></li>
<li><p>Additional functions: abs, sign, max, min, len, sum, any, all, dir;</p></li>
<li><p>From mathutlis module: Vector, Matrix;</p></li>
<li><p>Python type conversions: tuple, list, str, dict, set, int, float.</p></li>
<li><p>External modules: np (for Numpy) and bpy (for blender data)</p></li>
</ul>
<p>This restriction is for security reasons. However, Python’s ecosystem does not guarantee that no one can call some unsafe operations by using some sort of language-level hacks. So, please be warned that usage of this node with JSON definition obtained from unknown or untrusted source can potentially harm your system or data.</p>
<p>Examples of valid expressions are:</p>
<ul class="simple">
<li><p>1.0</p></li>
<li><p>x</p></li>
<li><p>x+1</p></li>
<li><p>0.75*X + 0.25*Y</p></li>
<li><p>R * sin(phi)</p></li>
<li><dl class="simple">
<dt>f-string formatting is possible. like:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">f&quot;{x:04}&quot;</span></code> will return a zero padding of length 4 if positive numbers are passed in.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="inputs">
<h2>Inputs<a class="headerlink" href="#inputs" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p>Set of inputs for this node depends on used formulas. Each variable used in formula becomes one input. If there are no variables used in formula, then this node will have no inputs.</p></li>
<li><dl class="simple">
<dt>If you specify variables, and the node creates a socket for it, then you must connect a link into that socket, otherwise the node will return early and not process anything. (but it might still output from the previously cached result.</dt><dd><ul class="simple">
<li><p>the node will warn you using a message to say that the UI is not fully connected.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>The inputs have two properties, Depth and Transform:
- Depth: Exposed depth to the formula. 1 means exposing scalars, 2 means scalar list, 3 list of lists…
- Transform: Transformation done to the data before exposing to the formula. Offers:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘As Is’: Do not transform</p></li>
<li><p>‘Vector’: Transforms to mathutils Vector</p></li>
<li><p>‘Array’: Transforms to Numpy Array</p></li>
<li><p>‘Set’: Transforms to python set</p></li>
<li><p>‘String’: Transforms to regular string</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading">¶</a></h2>
<p>This node has the following parameters:</p>
<ul class="simple">
<li><p><strong>Dimensions</strong>. This parameter is available in the N panel only. It defines how many formulas the node will allow to specify and evaluate. Default value is 1. Maximum value is 4.</p></li>
<li><p><strong>Formula 1</strong> to <strong>Formula 4</strong> input boxes. Formulas theirselve. If no formula is specified, then nothing will be calculated for this dimension. Number of formula input boxes is defined by <strong>Dimensions</strong> parameter.</p></li>
<li><p><strong>Split</strong>. If the flag is set, then for each combination of input values, list of values calculated by formula is enclosed in separate list. Usually you will want to uncheck this if you are using only one formula. Usually you will want to check this if you are using more than one formula. Other combinations can be of use in specific cases. Unchecked by default.</p></li>
<li><dl class="simple">
<dt><strong>Wrapping</strong>.</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code>: removes an outer layer of square brackets</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.0</span></code>: does nothing to the output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">+1</span></code>: will wrap the output one more time.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Use AST</strong>: (Default is off)</dt><dd><ul>
<li><p>this mode is only available in socket-less mode. You may want to look at the implementation source if it’s doing things you aren’t expecting.</p></li>
<li><p>With AST off the original <code class="docutils literal notranslate"><span class="pre">safe_eval</span></code> is used.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><strong>List Match</strong>: list length matching method.</p></li>
<li><p><strong>List Output</strong>: Convert the output to list.</p></li>
<li><p><strong>Output</strong>: Output socket type.</p></li>
</ul>
<p>For example, let’s consider the following setup:</p>
<img alt="https://user-images.githubusercontent.com/284644/53962080-00c78700-410c-11e9-9563-855fca16537a.png" src="https://user-images.githubusercontent.com/284644/53962080-00c78700-410c-11e9-9563-855fca16537a.png" />
<p>Then the following combinations of flags are possible:</p>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Permalink to this heading">¶</a></h2>
<p><strong>Result</strong> - what we got as result.</p>
</section>
<section id="usage-examples">
<h2>Usage examples<a class="headerlink" href="#usage-examples" title="Permalink to this heading">¶</a></h2>
<p>Emulating the Compute mask node:</p>
<img alt="https://user-images.githubusercontent.com/10011941/106862493-802eae00-66c7-11eb-9dee-6f1ff92e98be.png" src="https://user-images.githubusercontent.com/10011941/106862493-802eae00-66c7-11eb-9dee-6f1ff92e98be.png" />
<p>Using Vectors</p>
<img alt="https://user-images.githubusercontent.com/10011941/106863547-fa136700-66c8-11eb-8a0b-26dfc53d0836.png" src="https://user-images.githubusercontent.com/10011941/106863547-fa136700-66c8-11eb-8a0b-26dfc53d0836.png" />
<p>Numpy can be used for calculations</p>
<img alt="https://user-images.githubusercontent.com/10011941/106864164-cab12a00-66c9-11eb-893c-703d87705b23.png" src="https://user-images.githubusercontent.com/10011941/106864164-cab12a00-66c9-11eb-893c-703d87705b23.png" />
<p>Example exposing attributes of a surface and using the node to perform a to_nurbs transform</p>
<img alt="https://user-images.githubusercontent.com/10011941/106862141-fda5ee80-66c6-11eb-844f-8b0d6996f18b.png" src="https://user-images.githubusercontent.com/10011941/106862141-fda5ee80-66c6-11eb-844f-8b0d6996f18b.png" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="script_index.html" class="btn btn-neutral float-left" title="Script" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="formula_interpolate.html" class="btn btn-neutral float-right" title="Formula Interpolate" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014...2022, sverchok team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>